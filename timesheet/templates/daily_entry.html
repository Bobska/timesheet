{% extends 'base.html' %}
{% block title %}Daily Entry | FamilyHub Timesheet{% endblock %}

{% block breadcrumbs %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="{% url 'dashboard' %}">Dashboard</a></li>
    <li class="breadcrumb-item active" aria-current="page">Daily Entry</li>
  </ol>
</nav>
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>Daily Time Entries</h2>
  <div>
    <a href="{% url 'dashboard' %}" class="btn btn-sm btn-outline-secondary">Back to Dashboard</a>
    <a href="{% url 'weekly_summary' %}" class="btn btn-sm btn-outline-info">Weekly View</a>
  </div>
</div>

<div class="row mb-3">
  <div class="col-12 col-md-8">
    <div class="card mb-3">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">Entries for {{ date }}</h5>
        <form method="get" class="d-flex align-items-center">
          <input type="date" name="date" value="{{ date }}" class="form-control form-control-sm me-2" style="width: auto;">
          <button class="btn btn-sm btn-secondary">Go</button>
        </form>
      </div>
      <div class="card-body">
        <table class="table table-hover mb-0">
          <thead><tr><th>Job</th><th>Start</th><th>End</th><th>Break</th><th>Hours</th><th>Actions</th></tr></thead>
          <tbody>
            {% for entry in entries %}
              <tr>
                <td>{{ entry.job.display_name }}</td>
                <td>{{ entry.start_time }}</td>
                <td>{{ entry.end_time }}</td>
                <td>{{ entry.break_duration }} min</td>
                <td>{{ entry.total_hours }}</td>
                <td>
                  <a href="#" class="btn btn-sm btn-primary">Edit</a>
                  <a href="#" class="btn btn-sm btn-danger">Delete</a>
                </td>
              </tr>
            {% empty %}
              <tr><td colspan="6" class="text-center text-muted">No entries for this date. Add one below!</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="d-flex justify-content-between align-items-center mb-3">
      <div><strong>Daily Total:</strong> {{ entries|length|default:0 }} entries, {{ entries|map:'total_hours'|sum|default:0 }} hours</div>
      <div class="btn-group" role="group">
        <a href="?date={{ date|add:'-1' }}" class="btn btn-sm btn-outline-secondary">← Previous</a>
        <a href="?date={{ date|add:'1' }}" class="btn btn-sm btn-outline-secondary">Next →</a>
      </div>
    </div>
  </div>
  
  <div class="col-12 col-md-4">
    <div class="card mb-3">
      <div class="card-header">
        <h5 class="mb-0">Add/Edit Entry</h5>
      </div>
      <div class="card-body">
        <form method="post">{% csrf_token %}{{ form.as_p }}<button class="btn btn-primary w-100">Save Entry</button></form>
        <hr>
        <div class="d-grid gap-2">
          <a href="{% url 'job_create' %}" class="btn btn-outline-success btn-sm">Add New Job</a>
          <a href="{% url 'job_list' %}" class="btn btn-outline-secondary btn-sm">Manage Jobs</a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
