{% extends 'base.html' %}
{% block title %}Dashboard | FamilyHub Timesheet{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>Today's Dashboard</h2>
  <div>
    <a href="{% url 'daily_entry' %}" class="btn btn-sm btn-outline-primary">View Daily Entry</a>
    <a href="{% url 'job_create' %}" class="btn btn-sm btn-success">Add New Job</a>
  </div>
</div>

<div class="row mb-3">
  <div class="col-12 col-md-8">
    <div class="card mb-3">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">Today's Entries</h5>
        <small class="text-muted">{{ entries.0.date|default:today }}</small>
      </div>
      <div class="card-body">
        <table class="table table-hover mb-0">
          <thead><tr><th>Job</th><th>Start</th><th>End</th><th>Break</th><th>Hours</th></tr></thead>
          <tbody>
            {% for entry in entries %}
              <tr>
                <td>{{ entry.job.display_name }}</td>
                <td>{{ entry.start_time }}</td>
                <td>{{ entry.end_time }}</td>
                <td>{{ entry.break_duration }} min</td>
                <td>{{ entry.total_hours }}</td>
              </tr>
            {% empty %}
              <tr><td colspan="5" class="text-center text-muted">No entries for today. <a href="{% url 'daily_entry' %}">Add your first entry</a></td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    <div class="d-flex justify-content-between align-items-center mb-3">
      <div><strong>Daily Total:</strong> {{ entries|length|default:0 }} entries, {{ entries|map:'total_hours'|sum|default:0 }} hours</div>
      <div>
        <a href="{% url 'daily_entry' %}" class="btn btn-sm btn-outline-secondary">View All Daily Entries</a>
        <a href="{% url 'weekly_summary' %}" class="btn btn-sm btn-outline-info">Weekly Summary</a>
      </div>
    </div>
  </div>
  <div class="col-12 col-md-4">
    <div class="card mb-3">
      <div class="card-header">
        <h5 class="mb-0">Quick Add Entry</h5>
      </div>
      <div class="card-body">
        <form method="post">{% csrf_token %}{{ form.as_p }}<button class="btn btn-primary w-100">Add Entry</button></form>
        <hr>
        <div class="d-grid gap-2">
          <a href="{% url 'daily_entry' %}" class="btn btn-outline-primary btn-sm">Full Entry Form</a>
          <a href="{% url 'job_list' %}" class="btn btn-outline-secondary btn-sm">Manage Jobs</a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
